In the following we will give a detailed overview how to specify models in Python and how to call the generated simulation files.

\subsubsection*{Model Definition}

This guide will guide the user on how to specify models in Python using S\+B\+ML. For example implementations see the examples in the python/examples directory.

\paragraph*{S\+B\+ML input}

First, import an sbml file using the {\ttfamily \mbox{\hyperlink{classamici_1_1sbml__import_1_1_sbml_importer}{amici.\+sbml\+\_\+import.\+Sbml\+Importer}}} class\+: \begin{DoxyVerb}import amici
sbmlImporter = amici.SbmlImporter('model_steadystate_scaled.sbml')
\end{DoxyVerb}


the sbml document as imported by \href{http://sbml.org/Software/libSBML}{\texttt{ lib\+S\+B\+ML}} is available as \begin{DoxyVerb}sbml = sbmlImporter.sbml
\end{DoxyVerb}


\paragraph*{Constants}

parameters that should be considered constants can be specified in a list of strings specifying the respective Sbml\+Id of a parameter. \begin{DoxyVerb}constantParameters=['k4']
\end{DoxyVerb}


\paragraph*{Observables}

assignment rules that should be considered as observables can extracted using the {\ttfamily amici.\+assignment\+Rules2observables} function \begin{DoxyVerb}observables = amici.assignmentRules2observables(sbml, filter=lambda variableId: 
                                                variableId.startswith('observable_') and not variableId.endswith('_sigma'))
\end{DoxyVerb}


\paragraph*{Standard Deviations}

standard deviations can be specified as dictionaries ... \begin{DoxyVerb}sigmas = {'observable_x1withsigma': 'observable_x1withsigma_sigma'}
\end{DoxyVerb}


\subsubsection*{Model Compilation}

to compile the sbml as python module, the user has to call the method {\ttfamily \mbox{\hyperlink{classamici_1_1sbml__import_1_1_sbml_importer_ab02f5c6e1bc803fe8223280ebb555a82}{amici.\+sbml\+\_\+import.\+Sbml\+Importer.\+sbml2amici}}}, passing all the previously defined model specifications \begin{DoxyVerb}sbmlImporter.sbml2amici('test', 'test', 
                        observables=observables,
                        constantParameters=constantParameters,
                        sigmas=sigma)
\end{DoxyVerb}


Note\+: To build A\+M\+I\+CI with Open\+MP support, which allows to parallelize model simulations of multiple experimental conditions, set the environment variables {\ttfamily A\+M\+I\+C\+I\+\_\+\+C\+X\+X\+F\+L\+A\+GS} and {\ttfamily A\+M\+I\+C\+I\+\_\+\+L\+D\+F\+L\+A\+GS} to the correct Open\+MP flags of your compiler and linker, respectively. This has to be done for both A\+M\+I\+CI package installation {\itshape and} model compilation. When using {\ttfamily gcc} on Linux, use\+: \begin{DoxyVerb}# on your shell:
AMICI_CXXFLAGS=-fopenmp AMICI_LDFLAGS=-fopenmp pip3 install amici

# in python, before model compilation:
import os
os.environ['AMICI_CXXFLAGS'] = '-fopenmp'
os.environ['AMICI_LDFLAGS'] = '-fopenmp'
\end{DoxyVerb}


\subsubsection*{Model Simulation}

currently the model folder has to be manually added to the python path \begin{DoxyVerb}import sys
sys.path.insert(0, 'test')
\end{DoxyVerb}


the compiled model can now be imported as python module \begin{DoxyVerb}import test as modelModule
\end{DoxyVerb}


to obtain a model instance call the {\ttfamily get\+Model()} method. This model instance will be instantiated using the defautl parameter values specified in the sbml. \begin{DoxyVerb}model = modelModule.getModel()
\end{DoxyVerb}


then pass the simulation timepoints to {\ttfamily \mbox{\hyperlink{classamici_1_1_model_a50f9642f9bcb883dbd3925c85abc4c24}{amici.\+Model.\+set\+Timepoints}}} \begin{DoxyVerb}model.setTimepoints(np.linspace(0, 60, 60)) 
\end{DoxyVerb}


for simulation we need to generate a solver instance \begin{DoxyVerb}solver = model.getSolver()
\end{DoxyVerb}


the model simulation can now be carried out using {\ttfamily \mbox{\hyperlink{namespaceamici_a025192a6f53e19eae958cd3b14786f80}{amici.\+run\+Amici\+Simulation}}} \begin{DoxyVerb}rdata = amici.runAmiciSimulation(model, solver)
\end{DoxyVerb}
 